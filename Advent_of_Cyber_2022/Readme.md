#  Advent of Cyber 2022

grayshader | 08 April

**Frame works**
Security Frameworks 
```
	|
	|------> NIST 
	|
	|------>ISO 27000 Series
	|
	|------>MITRE ATT&CK Framework
	|
	|------>Cyber kill chain
	|
	|------>Unified Kill Chain
			|
			|---> CYCLE 1: In  => 	
			
			Reconnaissance: The attacker performs research on the target using publicly available information.
			
			Weaponisation: Setting up the needed infrastructure to host the command and control centre (C2) is crucial in executing attacks.
			
			Delivery: Payloads are malicious instruments delivered to the target through numerous means, such as email phishing and supply chain attacks.
			
			Social Engineering: The attacker will trick their target into performing untrusted and unsafe action against the payload they just delivered, often making their message appear to come from a trusted in-house source.
			
			Exploitation: If the attacker finds an existing vulnerability, a software or hardware weakness, in the network assets, they may use this to trigger their payload.
			
			Persistence: The attacker will leave behind a fallback presence on the network or asset to make sure they have a point of access to their target.
			
			Defence Evasion: The attacker must remain anonymous throughout their exploits by disabling and avoiding any security defence mechanisms enabled, including deleting evidence of their presence.
			
			Command & Control: Remember the infrastructure that the attacker prepared? A communication channel between the compromised system and the attacker’s infrastructure is established across the internet.
 			     
			|
			|---> CYCLE 2: Through  => 	
			Pivoting: Remember the system that the attacker may use for persistence? This system will become the attack launchpad for other systems in the network.

			Discovery: The attacker will seek to gather as much information about the compromised system, such as available users and data. Alternatively, they may remotely discover vulnerabilities and assets within the network. This opens the way for the next phase.

			Privilege Escalation: Restricted access prevents the attacker from executing their mission. Therefore, they will seek higher privileges on the compromised systems by exploiting identified vulnerabilities or misconfigurations.

			Execution: With elevated privileges, malicious code may be downloaded and executed to extract sensitive information or cause further havoc on the system.
			Credential Access: Part of the extracted sensitive information would include login credentials stored in the hard disk or memory. This provides the attacker with more firepower for their attacks.

			Lateral Movement: Using the extracted credentials, the attacker may move around different systems or data storages within the network, for example, within a single department.
			|
			|---> CYCLE 3: Out
			Collection: After finding the jackpot of data and information, the attacker will seek to aggregate all they need. By doing so, the assets’ confidentiality would be compromised entirely, especially when dealing with trade secrets and financial or personally identifiable information (PII) that is to be secured.

			Exfiltration: The attacker must get his loot out of the network. Various techniques may be used to ensure they have achieved their objectives without triggering suspicion.

			Impact: When compromising the availability or integrity of an asset or information, the attacker will use all the acquired privileges to manipulate, interrupt and sabotage. Imagine the reputation, financial and social damage an organisation would have to recover from.

			Objectives: Attackers may have other goals to achieve that may affect the social or technical landscape that their targets operate within. Defining and understanding these objectives tends to help security teams familiarise themselves with adversarial attack tools and conduct risk assessments to defend their assets.
```

1. Who is the adversary that attacked Santa's network this year?
```
	The Bandit Yeti
```
2. What's the flag that they left behind?
```
	THM{IT'S A Y3T1 CHR1$TMA$}
```
**Log analysis**

export IP=10.10.202.153
ssh creds
```
    IP address: 10.10.202.153
    Username: elfmcblue
    Password: tryhackme!
```
$ grep "santa" webserver.log
```
10.10.249.191 - - [18/Nov/2022:12:34:39 +0000] "GET /santaslist.txt HTTP/1.1" 200 133872 "-" "Wget/1.19.4 (linux-gnu)"
```
1. Use the ls command to list the files present in the current directory. How many log files are present?
```
	2 ssh log and webserver log
```
2. Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?
```
	webserver log
```
3. On what day was Santa's naughty and nice list stolen?
```
	Friday
```

4. What is the IP address of the attacker?
```
	 10.10.249.191
```
5. What is the name of the important list that the attacker stole from Santa?
```
	santaslist.txt
```

command :: grep  "THM" SSHD.log

6. Flag?
```
 	THM{STOLENSANTASLIST}
````

**OSINT**


site ::http://santagift.shop/

whois   santagift.shop

found source code on : https://github.com/muhammadthm/SantaGiftShop
sensitive informations (like creds)
```
config.php -> first line 
```
1. What is the name of the Registrar for the domain santagift.shop?

```
	NAMECHEAP INC
```
2. Find the website's source code (repository) on github.com and open the file containing sensitive credentials. Can you find the flag?
```
	{THM_OSINT_WORKS}
```
3. What is the name of the file containing passwords?
```
	config.php
```
4. What is the name of the QA server associated with the website?
```
	qa.santagift.shop in file config.php
```
5. What is the DB_PASSWORD that is being reused between the QA and PROD environments?
```
	S@nta2022
```

**Scanning**

1. What is the name of the HTTP server running on the remote host?
```
	Apache httpd 2.4.29
```
2. What is the name of the service running on port 22 on the QA server?
```
	ssh	
```
smbclient //10.10.153.11/Admins -U ubuntu
password::S@nta2022

3. What flag can you find after successfully accessing the Samba service?
```
	{THM_SANTA_SMB_SERVER}
```
4. What is the password for the username santahr?
```
	santa25 (found in file userfiles in smb)
```
5.
